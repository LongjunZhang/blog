<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"longjunzhang.github.io","root":"/blog/","images":"/blog/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="介绍 Lombok 的各种使用技巧">
<meta property="og:type" content="article">
<meta property="og:title" content="你真的会使用 Lombok 吗?">
<meta property="og:url" content="https://longjunzhang.github.io/blog/2024/07/11/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E4%BD%BF%E7%94%A8-Lombok-%E5%90%97/index.html">
<meta property="og:site_name" content="龙军的技术博客">
<meta property="og:description" content="介绍 Lombok 的各种使用技巧">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-07-11T11:59:52.000Z">
<meta property="article:modified_time" content="2024-07-11T12:01:31.048Z">
<meta property="article:author" content="Frank">
<meta property="article:tag" content="Lombok">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://longjunzhang.github.io/blog/2024/07/11/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E4%BD%BF%E7%94%A8-Lombok-%E5%90%97/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://longjunzhang.github.io/blog/2024/07/11/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E4%BD%BF%E7%94%A8-Lombok-%E5%90%97/","path":"2024/07/11/你真的会使用-Lombok-吗/","title":"你真的会使用 Lombok 吗?"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>你真的会使用 Lombok 吗? | 龙军的技术博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">龙军的技术博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">背景介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stable-%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">Stable 注解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%BF%E6%8D%A2%E5%86%97%E9%95%BF%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="nav-number">2.1.</span> <span class="nav-text">替换冗长的变量类型定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9toString-%E6%96%B9%E6%B3%95%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="nav-number">2.2.</span> <span class="nav-text">修改toString()方法的结果</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%88%90%E5%91%98%E5%8F%98%E9%87%8Fget-set%E6%96%B9%E6%B3%95%E8%AE%BF%E9%97%AE%E7%BA%A7%E5%88%AB"><span class="nav-number">2.3.</span> <span class="nav-text">修改成员变量get&#x2F;set方法访问级别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NPE-%E6%A3%80%E6%9F%A5"><span class="nav-number">2.4.</span> <span class="nav-text">NPE 检查</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90"><span class="nav-number">2.5.</span> <span class="nav-text">释放资源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%9B%E5%87%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8"><span class="nav-number">2.6.</span> <span class="nav-text">抛出自定义异常</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%87%92%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90"><span class="nav-number">2.7.</span> <span class="nav-text">懒加载资源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.8.</span> <span class="nav-text">构造者模式创建对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%B1%9E%E6%80%A7%E5%80%BC%E7%9B%B8%E4%BC%BC%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.9.</span> <span class="nav-text">创建属性值相似的对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E8%AE%B0%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8-%E6%82%B2%E8%A7%82%E9%94%81"><span class="nav-number">2.10.</span> <span class="nav-text">标记线程安全(悲观锁)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E8%AE%B0%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8-%E4%B9%90%E8%A7%82%E9%94%81"><span class="nav-number">2.11.</span> <span class="nav-text">标记线程安全(乐观锁)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%97%A5%E5%BF%97%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.12.</span> <span class="nav-text">创建日志对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="nav-number">2.13.</span> <span class="nav-text">生成构造方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E5%86%99equals-hashCode%E6%96%B9%E6%B3%95"><span class="nav-number">2.14.</span> <span class="nav-text">重写equals&amp;hashCode方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%88%E6%88%90%E5%A4%9A%E4%B8%AALombok%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.15.</span> <span class="nav-text">合成多个Lombok注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%B1%BB"><span class="nav-number">2.16.</span> <span class="nav-text">创建不可变类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Lombok-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">Lombok 高级用法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.</span> <span class="nav-text">使用方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.2.</span> <span class="nav-text">使用示例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#set-set%E9%93%BE%E8%A1%A8%E6%96%B9%E6%B3%95%E7%94%9F%E6%88%90"><span class="nav-number">3.2.1.</span> <span class="nav-text">set&#x2F;set链表方法生成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NonNull%E6%8A%9B%E5%87%BA%E5%85%B6%E4%BB%96%E5%BC%82%E5%B8%B8"><span class="nav-number">3.2.2.</span> <span class="nav-text">@NonNull抛出其他异常</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Frank</p>
  <div class="site-description" itemprop="description">人是一棵会思考芦苇</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://longjunzhang.github.io/blog/2024/07/11/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E4%BD%BF%E7%94%A8-Lombok-%E5%90%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Frank">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="龙军的技术博客">
      <meta itemprop="description" content="人是一棵会思考芦苇">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="你真的会使用 Lombok 吗? | 龙军的技术博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          你真的会使用 Lombok 吗?
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-07-11 19:59:52 / 修改时间：20:01:31" itemprop="dateCreated datePublished" datetime="2024-07-11T19:59:52+08:00">2024-07-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h1><blockquote>
<p>Lombok 在 Java 日常开发中，使用频繁非常之高，而且由于 Lombok 提供的注解都是<code>@Retention(RetentionPolicy.SOURCE)</code>级别，因此样板代码都是编译期生成的，对代码运行期的性能没有影响。</p>
</blockquote>
<p>虽然 Lombok 在业务开发中出现频率很高，但真正会使用 Lombok 注解的人还是很少很少——大部分还停留在简单使用<code>@Data, @ToString, @Getter, @SneakyThrows</code>阶段。原因无他，很多人其实没有看懂 <a target="_blank" rel="noopener" href="https://projectlombok.org/">Lombok 官方文档</a>。<br>本文旨解决以下几个问题</p>
<ol>
<li>帮读者理解什么是<code>Boilerplate Code</code>(像<code>getXxx(), setXxx(), toString()</code> 很容易认出来是 Boilerplate Code；但有些代码，不容易被开发者归纳出来)</li>
<li>理解业务开发中正确使用 Lombok 注解的场景</li>
<li>Lombok 高级用法</li>
</ol>
<h1 id="Stable-注解"><a href="#Stable-注解" class="headerlink" title="Stable 注解"></a>Stable 注解</h1><blockquote>
<p>首先要明白，Lombok 的所有注解是分为 <a target="_blank" rel="noopener" href="https://projectlombok.org/features/">Stable</a> 和 <a target="_blank" rel="noopener" href="https://projectlombok.org/features/experimental/"><strong>Experimental</strong></a>。<br>**Experimental **注解意味着，不稳定，将来新版本可能不再支持，有 bug 不会及时修复，等等；所以，官方文档建议开发者，主要使用 <strong>Stable</strong> 注解。</p>
</blockquote>
<h2 id="替换冗长的变量类型定义"><a href="#替换冗长的变量类型定义" class="headerlink" title="替换冗长的变量类型定义"></a>替换冗长的变量类型定义</h2><blockquote>
<p>通常我们不会单独定义一个局部变量<code>String msg;</code>，而是会使用局部变量引用某个结果<code>String msg = getMsg();</code><br>如果引用的类型名称很长，显式地写出引用类型名称是繁琐且不优雅的（即使我们可以通过 IDEA 的<code>.</code>快捷方式自动生成引用类型名称）。<br>因为 Java 是强类型语言，所以当我们想要查看一个变量所引用的类型，最好的方式永远是查看<code>=</code>右边部分，而不是左边变量类型。（因为存在多态，例如<code>List&lt;Integer&gt; list = new LinkedList&lt;&gt;(); List&lt;Integer&gt; list = new LinkedList&lt;&gt;();</code>，无法直接通过<code>=</code>左边的类型判断其真正引用的对象的类型）<br>因此，我们可以认为<code>=</code>左边的变量类型定义是多余且不优雅的，即 <strong>Boilerplate Code</strong>.<br>使用<code>var, val</code>可以替换这些 <strong>Boilerplate Code</strong></p>
</blockquote>
<p>使用<code>var</code>替换局部变量类型定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line"><span class="type">FileImageInputStream</span> <span class="variable">fileImageInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileImageInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./image.png&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// After</span></span><br><span class="line"><span class="type">var</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileImageInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./image.png&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>使用<code>val</code>替换<code>final</code>修饰的局部变量类型定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line"><span class="keyword">final</span> Map&lt;Integer, User&gt; userMap = userList.stream().collect(toMap(User::getId, Function.identity()));</span><br><span class="line"></span><br><span class="line"><span class="comment">// After</span></span><br><span class="line"><span class="type">val</span> <span class="variable">userFinalMap</span> <span class="operator">=</span> userList.stream().collect(toMap(User::getId, Function.identity());</span><br></pre></td></tr></table></figure>
<h2 id="修改toString-方法的结果"><a href="#修改toString-方法的结果" class="headerlink" title="修改toString()方法的结果"></a>修改<code>toString()</code>方法的结果</h2><p><code>@ToString</code>注解内部的属性值，可以控制<code>toString()</code>方法的输出结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">    <span class="comment">// 对非静态成员变量toString()排序</span></span><br><span class="line">    <span class="comment">// 修改非静态成员变量toString()变量名称</span></span><br><span class="line">    <span class="meta">@ToString</span>.Include(rank = -<span class="number">1</span>, name = <span class="string">&quot;财产&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">wealth</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="comment">// 是否输出父类的变量名称</span></span><br><span class="line"><span class="meta">@ToString(callSuper = true)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="comment">// 指定排除某些非静态成员变量</span></span><br><span class="line">    <span class="meta">@ToString</span>.Exclude</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@D</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="comment">// 仅包含指定字段</span></span><br><span class="line"><span class="meta">@ToString(callSuper = true, onlyExplicitlyIncluded = true)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">    <span class="meta">@ToString</span>.Include</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="meta">@ToString</span>.Include</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="type">Son</span> <span class="variable">son</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="number">1</span>, <span class="string">&quot;18719192020&quot;</span>, <span class="string">&quot;Jack&quot;</span>);</span><br><span class="line">System.out.println(son);	<span class="comment">// Son(super=Father(财产=100), id=1, name=Jack)</span></span><br></pre></td></tr></table></figure>
<h2 id="修改成员变量get-set方法访问级别"><a href="#修改成员变量get-set方法访问级别" class="headerlink" title="修改成员变量get/set方法访问级别"></a>修改成员变量<code>get/set</code>方法访问级别</h2><p><code>@Getter, @Setter</code>提供了 AccessLevel 级别，去修改生成的<code>getXxx(), setXxx()</code>方法的访问权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">    <span class="meta">@Getter(AccessLevel.PRIVATE)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">wealth</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Setter(AccessLevel.PRIVATE)</span></span><br><span class="line">    <span class="keyword">private</span> String addr;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Father</span> <span class="variable">father</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Father</span>();</span><br><span class="line">father.getWealth(); <span class="comment">// 报错</span></span><br><span class="line">father.setAddr(<span class="string">&quot;China&quot;</span>);	<span class="comment">//报错</span></span><br></pre></td></tr></table></figure>
<h2 id="NPE-检查"><a href="#NPE-检查" class="headerlink" title="NPE 检查"></a>NPE 检查</h2><blockquote>
<p>在 Spring 开发中，我们会用<code>validation</code>框架来帮助我们校验参数是否满足要求；同理，在所有代码中最头痛的永远是 NPE 问题，因为它无处不在。（_虽然 Java8 提供了 Optional 类来帮助我们控制 NPE 问题，但是 Optional 类需要强制开发者主动使用，才能在后续关联代码中避免出现 NPE 问题_）<br>因此，日常开发中，为了保证从第三方或者其他 API 中获取的数据不为空，我们经常会写一大堆的空指针校验代码去处理 NPE；显然，这部分代码是 Boilerplate Code</p>
</blockquote>
<p><code>@NonNull</code>用于简单参数是否为空</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">setName</span><span class="params">(<span class="meta">@NonNull</span> String name)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后生成</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">setName</span><span class="params">(<span class="meta">@NonNull</span> String name)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;name is marked non-null but is null&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="释放资源"><a href="#释放资源" class="headerlink" title="释放资源"></a>释放资源</h2><p><code>@Cleanup</code>注解源码中，清晰地展示了该注解生成的 Boilerplate Code 的样子，这里不再赘述。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cleanup</span> <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;some/file&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>这里需要注意一种特殊情况，当我们的释放资源的方法名不是<code>close()</code>方法时，则需要手动指定方法名称</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关闭资源的方法名称特殊</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpecialStreamResource</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭资源</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">specialClose</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定特殊的 close 方法</span></span><br><span class="line"><span class="meta">@Cleanup(&quot;specialClose&quot;)</span> <span class="type">SpecialStreamResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpecialStreamResource</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后生成的 Boilerplate Code</span></span><br><span class="line"><span class="type">SpecialStreamResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpecialStreamResource</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// TODO resource do something...</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (resource != <span class="literal">null</span>) &#123;</span><br><span class="line">        resource.specialClose();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="抛出自定义异常"><a href="#抛出自定义异常" class="headerlink" title="抛出自定义异常"></a>抛出自定义异常</h2><blockquote>
<p>异常处理的代码，除了抛出的异常类型不同，整个<code>catch</code>的逻辑基本都是相同的；而且因为<code>try &#123;...&#125; catch() &#123;...&#125; </code>结构会产生局部作用域，所以经常会导致代码很割裂，使得变量的定义与赋值分开，导致代码可读性下降。<br>使用<code>@SneakyThrows</code>注解可以完美解决 Boilerplate Code 问题，而且不会打破原来代码结构，提供可读性。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SneakyThrows(UnsupportedOperationException.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">float</span> <span class="title function_">divide</span><span class="params">(<span class="type">float</span> a)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="懒加载资源"><a href="#懒加载资源" class="headerlink" title="懒加载资源"></a>懒加载资源</h2><blockquote>
<p>应用在启动时，往往会加载大量的必备资源来完整启动应用，如果有些资源的加载很耗时，是会严重影响到应用的启动速度的。<br>因此，对于这些很耗时耗 CPU 的资源，一般建议使用懒加载策略，这样可以很好减轻系统刚刚启动时的负载，让应用启动更快速。<br>这种懒加载模式的代码，也是一种固定套路的写法，因此也是一种 Boilerplate Code</p>
</blockquote>
<p>Lombok 提供了<code>@Getter(lazy=true)</code>方法来实现懒加载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter(lazy=true)</span> <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">double</span>[] cached = initResource();</span><br><span class="line"></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">double</span>[] initResource() &#123;</span><br><span class="line">    <span class="comment">// 模拟初始化耗时 10min</span></span><br><span class="line">    TimeUnit.MINUTES.sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">double</span>[]&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后生成的样板代码</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> java.util.concurrent.AtomicReference&lt;java.lang.Object&gt; cached = <span class="keyword">new</span> <span class="title class_">java</span>.util.concurrent.AtomicReference&lt;java.lang.Object&gt;();</span><br><span class="line"><span class="keyword">public</span> <span class="type">double</span>[] getCached() &#123;</span><br><span class="line">    java.lang.<span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">this</span>.cached.get();</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="built_in">this</span>.cached) &#123;</span><br><span class="line">            value = <span class="built_in">this</span>.cached.get();</span><br><span class="line">            <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="type">double</span>[] actualValue = initResource();</span><br><span class="line">                value = actualValue == <span class="literal">null</span> ? <span class="built_in">this</span>.cached : actualValue;</span><br><span class="line">                <span class="built_in">this</span>.cached.set(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">double</span>[])(value == <span class="built_in">this</span>.cached ? <span class="literal">null</span> : value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Lombok 还很贴心的把懒加载的对象使用<code>AtomicReference</code>包装了起来，这样的好处是保证了线程安全。<br>事实上，对于很多我们需要懒加载的“Heavy”资源，一般全局只会创建一个。因此为了保证多线程竞争场景下的线程安全，这里使用<code>AtomicReference</code>是极其合理的设计。</p>
<h2 id="构造者模式创建对象"><a href="#构造者模式创建对象" class="headerlink" title="构造者模式创建对象"></a>构造者模式创建对象</h2><blockquote>
<p>当我们需要创建对象的同时, 给对象每个属性赋值时, Java 默认生成的方法, 有 2 种实现方式</p>
<ol>
<li>使用全参数的构造函数创建对象</li>
<li>先使用默认空参构造方法创建对方, 然后分别依次调用<code>setXxx()</code>方法赋值</li>
</ol>
</blockquote>
<p>使用方法 1 , 当属性过多的时候, 难以分辨参数对应的值, 可读性不好; 使用方法 2 , 可读性好, 但是由于<code>setXxx()</code>方法的返回值是<code>Void</code>, 因此需要使用 N 条语句来实现赋值, 存在大量的冗余.</p>
<blockquote>
<p>其中, 大量的<code>setXxx()</code>可以认为就是某种形式的 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了<code>@Builder</code>注解来实现构造器创建对象.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BuilderExample</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 不参与赋值的默认属性, 可以直接赋值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Builder</span>.Default</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="variable">created</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 属性名必须是复数形式, 否则 <span class="doctag">@Builder</span> 报错</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Singular</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; foods;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">BuilderExample</span> <span class="variable">builderExample</span> <span class="operator">=</span> BuilderExample.builder()</span><br><span class="line">        .name(<span class="string">&quot;Jack&quot;</span>)</span><br><span class="line">        <span class="comment">// 对于 collection 类型, 可以依次添加</span></span><br><span class="line">        .food(<span class="string">&quot;Apple&quot;</span>)</span><br><span class="line">        .food(<span class="string">&quot;Orange&quot;</span>)</span><br><span class="line">        <span class="comment">// 清空之前的 foods</span></span><br><span class="line">        .clearFoods()</span><br><span class="line">        <span class="comment">// 或者直接添加一个 collection 对象</span></span><br><span class="line">        .foods(Arrays.asList(<span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;橘子&quot;</span>))</span><br><span class="line">        .build();</span><br><span class="line"><span class="comment">// BuilderExample(created=1719823278241, foods=[苹果, 橘子], name=Jack)</span></span><br><span class="line">System.out.println(builderExample.toString());</span><br></pre></td></tr></table></figure>
<h2 id="创建属性值相似的对象"><a href="#创建属性值相似的对象" class="headerlink" title="创建属性值相似的对象"></a>创建属性值相似的对象</h2><blockquote>
<p>如果我们要创建几个对象, 这几个对象仅仅只是其中的一两个属性值不同, 但大部分属性值是相同的. 如果使用标准的 JavaBean 提供的方法, 则会出现大量重复代码去赋值相同属性, 这样的方式, 很 Boilerplate Code.</p>
</blockquote>
<p>Lombok 提供了<code>@With</code>注解, 生成<code>withXxx()</code>方法.<br>如果入参跟原对象不同, 则创建一个新的对象返回; 如果相同, 则不创建新对象. (<em>与 Java 8 时间 API 函数的</em><code>_withXxx()_</code><em>原理相似</em>)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@With(AccessLevel.PROTECTED)</span> <span class="comment">//可设置不同访问基本</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span>	<span class="comment">//必须提供全参构造函数, 否则 @With 不生效</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BuilderExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> created;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">BuilderExample</span> <span class="variable">jack</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BuilderExample</span>(<span class="number">1L</span>,<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line"><span class="type">BuilderExample</span> <span class="variable">withCreated</span> <span class="operator">=</span> jack.withCreated(<span class="number">2L</span>);</span><br><span class="line"><span class="type">BuilderExample</span> <span class="variable">withedName</span> <span class="operator">=</span> jack.withName(<span class="string">&quot;Jack&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(Objects.equals(jack, withCreated));	<span class="comment">//false</span></span><br><span class="line">System.out.println(Objects.equals(jack, withedName));	<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">System.out.println(jack);		<span class="comment">//BuilderExample(created=1, name=Jack)</span></span><br><span class="line">System.out.println(withCreated);<span class="comment">//BuilderExample(created=2, name=Jack)</span></span><br><span class="line">System.out.println(withedName);	<span class="comment">//BuilderExample(created=1, name=Jack)</span></span><br></pre></td></tr></table></figure>
<h2 id="标记线程安全-悲观锁"><a href="#标记线程安全-悲观锁" class="headerlink" title="标记线程安全(悲观锁)"></a>标记线程安全(悲观锁)</h2><blockquote>
<p>Java 提供的<code>synchronize</code>关键字用来标记代码块是线程安全的, 属于悲观锁, 任何时候, 无论线程执行什么操作, 代码块内同时只允许一个线程执行.<br><code>synchronize</code>使用过程中, 需要获取锁对象, 这部分代码也是 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了<code>@Synchronized</code>注解来实现标记方法是线程安全的.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedExample</span> &#123;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">readLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Synchronized</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Synchronized</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">answerToLife</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">42</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Synchronized(&quot;readLock&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">foo</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成的代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedExample</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静态方法的锁对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">$LOCK</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 实例方法的锁对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">$lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自定义的实例方法锁对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">readLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>($LOCK) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">answerToLife</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>($lock) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">42</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">foo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(readLock) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="标记线程安全-乐观锁"><a href="#标记线程安全-乐观锁" class="headerlink" title="标记线程安全(乐观锁)"></a>标记线程安全(乐观锁)</h2><blockquote>
<p>Java 中的<code>ReentrantReadWriteLock</code>可重入锁, 在使用的过程中, 获取锁对象和释放锁对象, 也是一种 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了注解<code>@Lock</code>来生成可重入锁相关的代码 (<em>注意, v1.20 版本开始使用</em><code>_@Locked_</code><em>, 低版本使用</em><code>_@Lock_</code>)<br>在实际使用过程中, 应根据不同的场景, 设置锁的级别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockedExample</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Locked</span>.Read</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Locked</span>.Write</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> newValue)</span> &#123;</span><br><span class="line">    value = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Locked(&quot;baseLock&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">foo</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockedExample</span> &#123;</span><br><span class="line">  <span class="comment">// 读写锁</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ReadWriteLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Lock</span> <span class="variable">baseLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.lock.readLock().lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.lock.readLock().unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(<span class="type">int</span> newValue)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.lock.writeLock().lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      value = newValue;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.lock.writeLock().unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">foo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.baseLock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.baseLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建日志对象"><a href="#创建日志对象" class="headerlink" title="创建日志对象"></a>创建日志对象</h2><blockquote>
<p>Java 支持很多日志框架, 不同的日志框架在实际使用过程中, 需要频繁地在每个使用的地方创建日志对象. 虽然这些日志对象分布在不同的类中, 但是其创建过程, 都是重复的, 这一部分代码也属于 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了大量的<code>@Log</code>注解的变型提供使用, 我们需要根据项目中引用的日志框架来决定使用哪个日志注解.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 项目中使用 Slf4j 日志框架</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="comment">// 生成代码</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.slf4j.<span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> org.slf4j.LoggerFactory.getLogger(LogExample.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 项目中使用自定义的日志框架</span></span><br><span class="line"><span class="meta">@CustomLog</span></span><br><span class="line"><span class="comment">// 生成代码</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> com.foo.your.<span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> com.foo.your.LoggerFactory.createYourLogger(LogExample.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更多日志注解, 参考文档</span></span><br><span class="line">https:<span class="comment">//projectlombok.org/features/log</span></span><br></pre></td></tr></table></figure>
<h2 id="生成构造方法"><a href="#生成构造方法" class="headerlink" title="生成构造方法"></a>生成构造方法</h2><blockquote>
<p>虽然大部分 IDE 都提供了生成 Java 构造方法的快捷键, 但从代码可读性角度而言, 这部分代码其实是冗余的, 也是 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了 3 个注解来生成不同的构造函数</p>
<ul>
<li><p><code>@NoArgsConstructor</code>生成无参构造方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoArgsConstructor(force = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line">    <span class="comment">// 如果存在 final 字段, 则直接使用会编译报错</span></span><br><span class="line">    <span class="comment">// 使用 force = true, 强制给所有 final 字段赋初始值 0/false/null</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后代码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// final 字段赋值</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成无参数的构造方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConstructorExample</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>@RequiredArgsConstructor</code>生成一个有参构造方法, 只对<code>final</code>和<code>@NonNull</code>修饰的字段生成</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Float</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">1.75f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后的代码</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @NonNull 注解标注的字段会被添加到构造器中</span></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 已被初始化赋值的 final 字段不会被添加到构造器中</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Float</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">1.75f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConstructorExample</span><span class="params">(Integer id, String name)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>@AllArgsConstructor</code>生成包含所有参数的构造器, 除了<code>final</code>修饰且赋初始值的字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AllArgsConstructor(staticName = &quot;of&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Float</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">1.75f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor(staticName = &quot;of&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConstructorExample</span> &#123;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Float</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">1.75f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ConstructorExample</span><span class="params">(Integer id, String name)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成静态方法用于创建对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ConstructorExample <span class="title function_">of</span><span class="params">(Integer id, String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ConstructorExample</span>(id, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="重写equals-hashCode方法"><a href="#重写equals-hashCode方法" class="headerlink" title="重写equals&amp;hashCode方法"></a>重写equals&amp;hashCode方法</h2><blockquote>
<p><code>equals(), hashCode()</code>虽然可以使用快捷键生成, 但生成的内容也是 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供的注解<code>@EqualsAndHashCode</code>生成相应方法, 需要注意以下几点</p>
<ol>
<li><code>static, transient</code>修饰的字段, 不参与生成</li>
<li>当注解标注的类存在父类时, 则需要设置属性<code>callSuper=true</code></li>
<li>Lombok 在生成<code>equals()</code>方法时, 会调用字段类型的<code>equals()</code>方法进行比较, 例如: <code>String</code>类型会调用<code>String</code>类中重写的<code>equals()</code>方法; 但是, Lombok 不会对**<em>八大原始类型和数组</em>**进行比较. 如果需要比较, 则需要手动实现比较. <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EqualsAndHashCodeExample</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">int</span> <span class="variable">transientVar</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> score;</span><br><span class="line">  <span class="meta">@EqualsAndHashCode</span>.Exclude <span class="keyword">private</span> <span class="type">Shape</span> <span class="variable">shape</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Square</span>(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">private</span> String[] tags;</span><br><span class="line">  <span class="meta">@EqualsAndHashCode</span>.Exclude <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@EqualsAndHashCode(callSuper=true)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Square</span> <span class="keyword">extends</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> width, height;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Square</span><span class="params">(<span class="type">int</span> width, <span class="type">int</span> height)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.width = width;</span><br><span class="line">      <span class="built_in">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
Lombok 生成的代码参见官网文档实例</li>
</ol>
<h2 id="合成多个Lombok注解"><a href="#合成多个Lombok注解" class="headerlink" title="合成多个Lombok注解"></a>合成多个Lombok注解</h2><blockquote>
<p>Lombok 每个注解对应一个功能, 在每个类上使用大量重复的注解, 显然也是某种程度上的 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了<code>@Data</code>注解来封装多个注解(类似于, <code>@SpringBootApplication</code>组合了很多其他注解一样), 需要注意的是<code>@Data</code>注解内部没有提供精细化的控制, 如果精细化控制生成的代码, 只需要将其他注解显示声明使用即可. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示声明 @Setter 注解, 可以覆盖 @Data 中的 @Setter</span></span><br><span class="line">    <span class="meta">@Setter(AccessLevel.PACKAGE)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> score;</span><br><span class="line">    <span class="keyword">private</span> String[] tags;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示声明 @ToString 方法</span></span><br><span class="line">    <span class="meta">@ToString(includeFieldNames = true)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成静态方法构建对象</span></span><br><span class="line">    <span class="meta">@Data(staticConstructor = &quot;of&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Exercise</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> T value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建不可变类"><a href="#创建不可变类" class="headerlink" title="创建不可变类"></a>创建不可变类</h2><blockquote>
<p>不可变类拥有特性部分, 也是一种 Boilerplate Code. </p>
</blockquote>
<p>Lombok 提供了注解<code>@Value</code>来声明一个类是不可变类, 自动生成不可变类拥有的一些属性和方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ValueExample</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="meta">@With(AccessLevel.PACKAGE)</span></span><br><span class="line">    <span class="meta">@NonFinal</span></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">double</span> score;</span><br><span class="line">    <span class="keyword">protected</span> String[] tags;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ToString(includeFieldNames = true)</span></span><br><span class="line">    <span class="meta">@Value(staticConstructor = &quot;of&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Exercise</span>&lt;T&gt; &#123;</span><br><span class="line">        String name;</span><br><span class="line">        T value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类被 final 修饰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ValueExample</span> &#123;</span><br><span class="line">    <span class="comment">// 默认字段被 private final 修饰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="comment">// @NonFinal 避免被 final 修饰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">double</span> score;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> String[] tags;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Lombok-高级用法"><a href="#Lombok-高级用法" class="headerlink" title="Lombok 高级用法"></a>Lombok 高级用法</h1><blockquote>
<p>Lombok 官网中为每个注解提供了 <strong>Supported configuration keys</strong> 的配置, 通过这些配置, 我们可以自定义 Lombok 生成的代码样式. </p>
</blockquote>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>在项目的根目录下，创建配置文件<code>lombok.config</code></p>
<ul>
<li>普通 Java 项目保持同一个目录下即可</li>
<li>SpringBoot 项目需要在<code>src/main/java/lombok.config</code></li>
</ul>
<h2 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h2><h3 id="set-set链表方法生成"><a href="#set-set链表方法生成" class="headerlink" title="set/set链表方法生成"></a><code>set/set</code>链表方法生成</h3><p>在<code>lombok.config</code>中添加配置<code>lombok.accessors.chain=true</code><br>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NonNullExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">NonNullExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NonNullExample</span>()</span><br><span class="line">        .setId(<span class="number">123</span>)</span><br><span class="line">        .setName(<span class="string">&quot;Jack&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="NonNull抛出其他异常"><a href="#NonNull抛出其他异常" class="headerlink" title="@NonNull抛出其他异常"></a><code>@NonNull</code>抛出其他异常</h3><p>在<code>lombok.config</code>中添加配置<code>lombok.nonNull.exceptionType=IllegalArgumentException</code><br>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NonNullExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NonNullExample</span><span class="params">(<span class="meta">@NonNull</span> String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">NonNullExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NonNullExample</span>(name);</span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line"><span class="comment">// Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: name is marked non-null but is null</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/Lombok/" rel="tag"># Lombok</a>
              <a href="/blog/tags/Java/" rel="tag"># Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2024/07/03/%E4%BC%98%E5%8C%96-CI-CD-%E6%B5%81%E7%A8%8B%E6%96%B9%E6%A1%88/" rel="prev" title="优化 CI/CD 流程方案">
                  <i class="fa fa-angle-left"></i> 优化 CI/CD 流程方案
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Frank</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/sidebar.js"></script><script src="/blog/js/next-boot.js"></script>

  






  





</body>
</html>
